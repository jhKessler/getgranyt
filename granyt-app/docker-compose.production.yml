# =====================================================
# Granyt App - Production Docker Compose
# =====================================================
#
# This file runs the full Granyt stack WITHOUT exposing any ports.
# Use this when running behind a reverse proxy (nginx, traefik, etc.)
#
# Quick Start:
# 1. Download this file: docker-compose.production.yml
# 2. Download the base file: docker-compose.base.yml
# 3. Create a .env file with the required variables (see below)
# 4. Run: docker compose -f docker-compose.base.yml -f docker-compose.production.yml up -d
# 5. Configure your reverse proxy to forward traffic to the app container
#
# Required .env file contents:
# ----------------------------
# POSTGRES_PASSWORD=your-secure-database-password
# BETTER_AUTH_SECRET=your-32-char-secret-key-here
# BETTER_AUTH_URL=https://your-domain.com
#
# Optional:
# POSTGRES_USER=granyt
# POSTGRES_DB=granyt
# GRANYT_VERSION=latest           # Pin to specific version: 1.0.0, 1.1.0, etc.
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USER=your-email@example.com
# SMTP_PASSWORD=your-smtp-password
# SMTP_FROM_EMAIL=alerts@your-domain.com
# SMTP_FROM_NAME=Granyt Alerts
#
# Reverse Proxy Configuration:
# ----------------------------
# The app service is accessible on port 3000 within the granyt-network.
# Configure your reverse proxy to connect to:
#   - Container: granyt-app-prod
#   - Port: 3000
#   - Network: granyt-network
#
# =====================================================

services:
  # =========================
  # PostgreSQL Database
  # =========================
  postgres:
    container_name: granyt-postgres-prod

  # =========================
  # Database Migrations
  # =========================
  migrations:
    container_name: granyt-migrations-prod

  # =========================
  # Next.js Application
  # =========================
  # No ports exposed - access via reverse proxy on granyt-network
  app:
    container_name: granyt-app-prod
